/* Nike -- marketing-automation.optimization-client -- 1.9.0 */
(()=>{"use strict";var e=function(e,n){this._locations=[],this._alloy=e,n&&(this._locations=n)},n=function(e,n,t,o){return new(t||(t=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function l(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,l)}c((o=o.apply(e,n||[])).next())}))},t=function(e,n){var t,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(t=1,o&&(r=2&l[0]?o.return:l[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,l[1])).done)return r;switch(o=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,o=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){i.label=l[1];break}if(6===l[0]&&i.label<r[1]){i.label=r[1],r=l;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(l);break}r[2]&&i.ops.pop(),i.trys.pop();continue}l=n.call(e,i)}catch(e){l=[6,e],o=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},o="ambiguous",r=function(){return r=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},r.apply(this,arguments)},i=function(e,n,t,o){return new(t||(t=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function l(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,l)}c((o=o.apply(e,n||[])).next())}))},a=function(e,n){var t,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(t=1,o&&(r=2&l[0]?o.return:l[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,l[1])).done)return r;switch(o=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,o=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){i.label=l[1];break}if(6===l[0]&&i.label<r[1]){i.label=r[1],r=l;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(l);break}r[2]&&i.ops.pop(),i.trys.pop();continue}l=n.call(e,i)}catch(e){l=[6,e],o=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},l="nikecom",c=function(){var e,n,t;return{language:(null==(t=null===(n=null===(e=window.webShellClient)||void 0===e?void 0:e.locale)||void 0===n?void 0:n.get())?void 0:t.language)||"en",country:(null==t?void 0:t.country)||"us"}};function u(){return i(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return[4,(e=window.webShellClient).identity.getIsLoggedIn()];case 1:return n.sent()?[4,e.identity.getUserProfile()]:[3,3];case 2:return[2,n.sent().registeredCountry];case 3:return[2,e.userLocation.current.country]}}))}))}var s=function(e){var n,t,o,i,a,u,s,d;try{var p=function(e){var n,t,o,r,i,a=e.location.href,l={"/t/":"pdp","/t-dark/":"pdp","/u-dark/":"pdp","/u/":"pdp","/w/":"pw","/w-dark/":"pw","/cart":"cart","/checkout":"checkout","/member":"member","/help":"help","/w?q":"onsite search"};if(a){var c=!1;Object.keys(l).forEach((function(e){!c&&a.includes(e)&&(c=!0,i=l[e])}))}if(!i)try{i=null===(r=null===(o=null===(t=null===(n=e.__NEXT_DATA__)||void 0===n?void 0:n.props)||void 0===t?void 0:t.pageProps)||void 0===o?void 0:o.navConfig)||void 0===r?void 0:r.analyticsPageType}catch(e){}return i}(e),f=function(e,n){var t,o,r,i,a,l,c,u,s,d,p,f,v,h,w,y,g,b,m,_,T,I,O,A,P,E,N,k,C=(null===(t=e.location)||void 0===t?void 0:t.pathname)||"";switch(n){case"pdp":k=null===(o=document.querySelector("#pdp_product_title"))||void 0===o?void 0:o.innerText.toLowerCase();break;case"pw":k=null===(s=null===(u=null===(c=null===(l=null===(a=null===(i=null===(r=e.__NEXT_DATA__)||void 0===r?void 0:r.props)||void 0===i?void 0:i.pageProps)||void 0===a?void 0:a.initialState)||void 0===l?void 0:l.Wall)||void 0===c?void 0:c.facetNav)||void 0===u?void 0:u.analytics)||void 0===s?void 0:s.legacyPageName.toLowerCase();break;case"homepage":k=N=null===(v=null===(f=null===(p=null===(d=e.__NEXT_DATA__)||void 0===d?void 0:d.props)||void 0===p?void 0:p.pageProps)||void 0===f?void 0:f.navConfig)||void 0===v?void 0:v.pageDetail;break;case"landing page":N=null===(g=null===(y=null===(w=null===(h=e.__NEXT_DATA__)||void 0===h?void 0:h.props)||void 0===w?void 0:w.pageProps)||void 0===y?void 0:y.navConfig)||void 0===g?void 0:g.globalNavPageName,k=null===(T=null===(_=null===(m=null===(b=e.__NEXT_DATA__)||void 0===b?void 0:b.props)||void 0===m?void 0:m.pageProps)||void 0===_?void 0:_.navConfig)||void 0===T?void 0:T.pageDetail;break;case"cart":N="cart",k="view";break;case"help":N="help";var L=C.split("/");2===L.length?k="home":C.includes("/search/")?k="search":C.includes("/a/")&&(k="article>".concat(L[L.length-1]));break;case"checkout":k="shipping";break;case"onsite search":k=(null===(E=null===(P=null===(A=null===(O=null===(I=e.__NEXT_DATA__)||void 0===I?void 0:I.props)||void 0===O?void 0:O.pageProps)||void 0===A?void 0:A.initialState)||void 0===P?void 0:P.Wall)||void 0===E?void 0:E.products.length)?"results found":"no search results";break;case"member":N="member",k=["inbox","profile","settings"].find((function(e){return C.includes(e)}))}return{pageName:N,pageDetail:k}}(e,p),v=f.pageName,h=f.pageDetail,w=function(e){var n;switch(e){case"pdp":case"homepage":case"landing page":case"cart":case"checkout":n=e;break;case"pw":n="product wall"}return n}(p),y=null===(o=null===(t=null===(n=null==e?void 0:e.webShellClient)||void 0===n?void 0:n.locale)||void 0===t?void 0:t.get())||void 0===o?void 0:o.currency,g=r({domain:"www.nike.com",backendPlatform:"cloud"},(d=w)&&{name:d}),b=function(e,n,t){var o=r(r({experienceType:l},n&&{pageType:n}),t&&{pageDetail:t});return r(r({},o),"landing page"===n||"homepage"===n?e&&{pageName:"".concat(l,">").concat(e)}:t&&{pageName:"".concat(l,">").concat(n,">").concat(t)})}(v,p,h),m=c();return r(r({app:g,view:b},y&&{currency:y}),{language:(null===(u=null===(a=null===(i=e.webShellClient)||void 0===i?void 0:i.locale)||void 0===a?void 0:a.get())||void 0===u?void 0:u.langRegion)||"en_US",locale:m})}catch(n){return e.newrelic&&e.newrelic.addPageAction("OPTIMIZATION_CLIENT_COMMON_PROPERTIES_ERROR",{host:e.location.host,errorName:n.name,errorMessage:n.message,stackTrace:null!==(s=n.stack)&&void 0!==s?s:""}),console.error("Failed to get common properties: ".concat(n.message)),{app:{backendPlatform:"",domain:"",name:"",version:""},view:{experienceType:"",pageName:"",pageType:"",pageDetail:""},language:"",locale:{country:"",language:""},currency:""}}};function d(e){var n=new RegExp("(^| )".concat(e,"=([^;]+)")),t=document.cookie.match(n);if(t)return t[2]}var p,f="EXP_OPTIMIZATION_CLIENT_WARN",v="EXP_OPTIMIZATION_CLIENT_ERROR",h=function(){return h=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},h.apply(this,arguments)};!function(e){e[e.CONTINUE=0]="CONTINUE",e[e.STOP=1]="STOP"}(p||(p={}));var w=function(){function e(){this.maxAttempts=10,this.interval=50,this.exponentRate=1.5}return e.run=function(e){var n=function(t){if(void 0===t&&(t=0),function(n){try{return e.onTick(n)}catch(n){return e.onError(n),p.STOP}}(t)!==p.STOP)if(t+1>=e.maxAttempts)e.onTimeout();else{var o=e.interval*Math.pow(t+1,e.exponentRate);setTimeout((function(){return n(t+1)}),o)}};return n(),e},e.runAsync=function(n){return new Promise((function(t,o){e.run(h(h({},new e),{onTick:function(){var e=n();return e?(t(e),p.STOP):p.CONTINUE},onError:o,onTimeout:function(){return t(null)}}))}))},e}();var y=function(e,n,t,o){return new(t||(t=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function l(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,l)}c((o=o.apply(e,n||[])).next())}))},g=function(e,n){var t,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(t=1,o&&(r=2&l[0]?o.return:l[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,l[1])).done)return r;switch(o=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,o=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){i.label=l[1];break}if(6===l[0]&&i.label<r[1]){i.label=r[1],r=l;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(l);break}r[2]&&i.ops.pop(),i.trys.pop();continue}l=n.call(e,i)}catch(e){l=[6,e],o=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},b=["adtargeting_behavioralevents","performance"],m=["au","id","in","jp","kr","my","nz","ph","sg","th","tw","vn","mx"];function _(){return y(this,void 0,void 0,(function(){var e,n,t,o;return g(this,(function(r){switch(r.label){case 0:return(null==(e=window.NikePrivacy)?void 0:e.isEnabled)?[4,e.isInitialized()]:[2,!1];case 1:return r.sent(),(n=null===(o=window.NikePrivacy)||void 0===o?void 0:o.permissions.get())?(t=n.flatMap((function(e){var n=e.category;return e.isEnabled?[n.toLocaleLowerCase()]:[]})),[2,b.every((function(e){return t.includes(e)}))]):[2,!1]}}))}))}function T(e){var n=e.toLocaleLowerCase();return m.includes(n)}function I(e){return y(this,void 0,void 0,(function(){return g(this,(function(n){switch(n.label){case 0:return[4,_()];case 1:return[2,n.sent()||T(e)||(t=d("sq"),!t||"3"===t||"1"===t)]}var t}))}))}function O(e){return y(this,void 0,void 0,(function(){var n,t,o,r,i,a;return g(this,(function(l){switch(l.label){case 0:n=!1,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,u()];case 2:return[4,I(l.sent())];case 3:return(n=l.sent())||(console.warn("Appropriate UGP permissions have not been given. Cannot fetch Adobe Target locations."),null===(o=window.newrelic)||void 0===o||o.addPageAction("EXP_OPTIMIZATION_CLIENT_NO_UGP_PERMISSION",{errorMessage:"Appropriate UGP permissions have not been given.",locations:e})),[3,5];case 4:return t=l.sent(),(null===(r=window.newrelic)||void 0===r?void 0:r.noticeError)&&(null===(i=window.newrelic)||void 0===i||i.addPageAction(function(e){try{var n=null==e?void 0:e.message;return/Network request failed/.test(n)?f:v}catch(e){return v}}(t),{host:window.location.host,errorName:t.name,errorMessage:t.message,stackTrace:null!==(a=t.stack)&&void 0!==a?a:"",locations:e.length?e:null})),console.error("Failed to find locations: ".concat(t.message)),[3,5];case 5:return[2,n]}}))}))}var A=function(e,n,t,o){return new(t||(t=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function l(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,l)}c((o=o.apply(e,n||[])).next())}))},P=function(e,n){var t,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(t=1,o&&(r=2&l[0]?o.return:l[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,l[1])).done)return r;switch(o=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,o=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){i.label=l[1];break}if(6===l[0]&&i.label<r[1]){i.label=r[1],r=l;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(l);break}r[2]&&i.ops.pop(),i.trys.pop();continue}l=n.call(e,i)}catch(e){l=[6,e],o=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};function E(){return void 0!==window.performance&&window.performance.now?window.performance.now():Date.now()}function N(e){return A(this,void 0,void 0,(function(){var n;return P(this,(function(t){switch(t.label){case 0:return n=E(),[4,e];case 1:return[2,{result:t.sent(),duration:E()-n}]}}))}))}var k,C=(k=function(e,n){return k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])},k(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=e}k(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),L=function(){return L=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},L.apply(this,arguments)},S=function(e,n,t,o){return new(t||(t=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function l(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,l)}c((o=o.apply(e,n||[])).next())}))},x=function(e,n){var t,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(t=1,o&&(r=2&l[0]?o.return:l[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,l[1])).done)return r;switch(o=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,o=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){i.label=l[1];break}if(6===l[0]&&i.label<r[1]){i.label=r[1],r=l;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(l);break}r[2]&&i.ops.pop(),i.trys.pop();continue}l=n.call(e,i)}catch(e){l=[6,e],o=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},D=function(e,n,t){if(t||2===arguments.length)for(var o,r=0,i=n.length;r<i;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))},M=function(e){function r(r,i){var a,l,c=e.call(this,r,i)||this;return c._fpid=null,c._callcount=0,c.getDatastreamToOverride=function(){var e;return e="datastreamId",new URL(window.location.href).searchParams.get(e)||null},c.getLocations=function(e){for(var o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];return S(c,D([e],o,!0),void 0,(function(e,o){var r,i,a,l,c,u,s,d,p,f,v,h,w,y,g,b,m,_,T,I,A,P,k;return void 0===o&&(o=!1),x(this,(function(C){switch(C.label){case 0:if(this._callcount++,r=this._callcount,i=null!==(_=null==e?void 0:e.locations)&&void 0!==_?_:this._locations,a=E(),!this.validateLocations(i))return[2,{locations:[]}];C.label=1;case 1:return C.trys.push([1,4,,5]),[4,Promise.all([N(O(i)),N(null===(T=window.analyticsClient)||void 0===T?void 0:T.isInitialized()),N(n(void 0,void 0,void 0,(function(){var e,n;return t(this,(function(t){switch(t.label){case 0:return[4,null===(n=window.webShellClient)||void 0===n?void 0:n.identity.getUserProfile()];case 1:return[2,{userId:null==(e=t.sent())?void 0:e.upmId,loggedIn:!!(null==e?void 0:e.upmId)}]}}))}))),N(this.getECID())])];case 2:return l=C.sent(),c=l[0],u=l[1],s=l[2],d=l[3],c.result?(p=s.result,f=p.loggedIn,v=p.userId,h=d.result,w=this.getFPID(),y=this.getSendEventObject(i,v,f,h,w),[4,N(this._alloy("sendEvent",y))]):[2,{locations:[]}];case 3:return g=C.sent(),b=g.result,null===(I=window.newrelic)||void 0===I||I.addPageAction("EXP_OPTIMIZATION_CLIENT_ALLOY_SUCCESS",{locations:i,duration:E()-a,alloyTiming:g.duration,profileTiming:s.duration,privacyTiming:c.duration,analyticsTiming:u.duration,getEcidTiming:d.duration,callCount:r}),[2,this.transformAlloyOffer(null==b?void 0:b.decisions,o,i,h,w,f)];case 4:return m=C.sent(),(null===(A=window.newrelic)||void 0===A?void 0:A.noticeError)&&(null===(P=window.newrelic)||void 0===P||P.addPageAction("EXP_OPTIMIZATION_CLIENT_ALLOY_ERROR",{host:window.location.host,errorName:null==m?void 0:m.name,errorMessage:null==m?void 0:m.message,stackTrace:null!==(k=null==m?void 0:m.stack)&&void 0!==k?k:"",locations:i.length?i:null})),console.error("Failed to find locations: ".concat(m.message)),[3,5];case 5:return[2,{locations:[]}]}}))}))},c.validateLocations=function(e){var n,t=!1;return e.length>0?t=!0:(console.error("Location must be provided to fetch activity details via Adobe Web SDK(AlloyJS)."),null===(n=window.newrelic)||void 0===n||n.addPageAction("EXP_OPTIMIZATION_CLIENT_ALLOY_NO_LOCATIONS",{errorMessage:"Location must be provided to fetch activity details via Adobe Web SDK(AlloyJS)."})),t},c.getLocationName=function(e){var n=[];return e.map((function(e){n.push(e.name)})),n},c.getLocationParameters=function(e,n,t){var o,r,i,a={appCountry:null===(r=null===(o=window.webShellClient)||void 0===o?void 0:o.locale.get().country)||void 0===r?void 0:r.toUpperCase(),appLanguage:null===(i=window.webShellClient)||void 0===i?void 0:i.locale.get().language,browserWidth:window.innerWidth,"profile.userId":n,"profile.loggedIn":t};return e.map((function(e){a=L(L({},a),e.parameters)})),a},c.getIdentityMap=function(e,n,t){var r={};return e&&(r.customerecid=[{id:e,authenticatedState:t?"authenticated":o}]),n&&(r.FPID=[{id:n,authenticatedState:o,primary:!0}]),r},c.sendDisplayNotification=function(e,n,t,o){return S(c,void 0,void 0,(function(){var r,i,a,l,c,u,s,d;return x(this,(function(p){switch(p.label){case 0:r=e.id,i=e.scope,a=e.scopeDetails,l=this.getIdentityMap(n,t,o),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this._alloy("sendEvent",{xdm:{eventType:"decisioning.propositionDisplay",_experience:{decisioning:{propositions:[{id:r,scope:i,scopeDetails:a}],propositionEventType:{display:1}},identityMap:l}}})];case 2:return p.sent(),[3,4];case 3:return c=p.sent(),(null===(u=window.newrelic)||void 0===u?void 0:u.noticeError)&&(null===(s=window.newrelic)||void 0===s||s.addPageAction("EXP_OPTIMIZATION_CLIENT_ALLOY_DISPLAY_EVENT_ERROR",{host:window.location.host,errorName:c.name,errorMessage:c.message,stackTrace:null!==(d=c.stack)&&void 0!==d?d:"",offer:e})),console.error("Failed to send a displayEvent: ".concat(c.message)),[3,4];case 4:return[2]}}))}))},c.transformAlloyOffer=function(e,n,t,o,r,i){var a=[];if(t.forEach((function(t){var l={name:t.name};e.forEach((function(e){var a,u,s,d,p,f;if(t.name===e.scope&&(l.analytics=(null===(u=null===(a=e.scopeDetails)||void 0===a?void 0:a.characteristics)||void 0===u?void 0:u.analyticsToken)||void 0,l.content=(null===(d=null===(s=e.items[0])||void 0===s?void 0:s.data)||void 0===d?void 0:d.content)||void 0,l.responseTokens={"experience.name":(null===(p=e.items[0])||void 0===p?void 0:p.meta["experience.name"])||void 0,"activity.name":(null===(f=e.items[0])||void 0===f?void 0:f.meta["activity.name"])||void 0},l.experimentActivatedCallback=function(){},l.analytics)){var v=function(){var n;try{return c.sendAdobeAnalyticsEvent(l),c.sendDisplayNotification(e,o,r,i),l.experimentActivatedCallback=function(){},!0}catch(e){return delete l.experimentActivatedCallback,window.newrelic&&window.newrelic.addPageAction("EXP_OPTIMIZATION_CLIENT_ALLOY_ANALYTICS_SEND_ERROR",{host:window.location.host,errorName:e.name,errorMessage:e.message,stackTrace:null!==(n=e.stack)&&void 0!==n?n:""}),console.error("Failed to send Analytics: ".concat(e.message)),!1}};n?l.experimentActivatedCallback=v:v()}})),a.push(l)})),a&&a.length>0)return{locations:a}},c.getECID=(l=null,function(){return l||(l=new Promise((function(e){return S(c,void 0,void 0,(function(){var n,t,o,r,i,a;return x(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,this._alloy("getIdentity")];case 1:return(n=l.sent())&&e(null===(o=n.identity)||void 0===o?void 0:o.ECID),[3,3];case 2:return t=l.sent(),(null===(r=window.newrelic)||void 0===r?void 0:r.noticeError)&&(null===(i=window.newrelic)||void 0===i||i.addPageAction("EXP_OPTIMIZATION_CLIENT_ALLOY_GETIDENTITY_ERROR",{host:window.location.host,errorName:t.name,errorMessage:t.message,stackTrace:null!==(a=t.stack)&&void 0!==a?a:"",locations:null})),console.error("Failed to fetch ecid using Alloy getIndentity method: ".concat(t.message)),e(null),[3,3];case 3:return[2]}}))}))}))),l}),c.getFPID=function(){return c._fpid||(c._fpid=d("ni_d")),c._fpid},c.getSendEventObject=function(e,n,t,o,r){var i=c.getLocationName(e),a=c.getLocationParameters(e,n,t),l=c.getIdentityMap(o,r,t);return{renderDecisions:!0,edgeConfigOverrides:{datastreamId:c.getDatastreamToOverride()},decisionScopes:i,xdm:{identityMap:l},data:{__adobe:{target:a}}}},null===(a=window.newrelic)||void 0===a||a.addPageAction("EXP_OPTIMIZATION_CLIENT_INITIALIZED",{}),c}return C(r,e),r.prototype.sendAdobeAnalyticsEvent=function(e){var n=s(window);window.webShellClient.analytics.track("Experiment Activated",L({"experience.name":e.responseTokens["experience.name"],"activity.name":e.responseTokens["activity.name"],abTest:{analytics:e.analytics}},n),{writeKey:"2iv4Qa7rFEipAs4iE850BkBpTYQvlAFZ"})},r}(e),R=function(e,n,t,o){return new(t||(t=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function l(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,l)}c((o=o.apply(e,n||[])).next())}))},j=function(e,n){var t,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(t=1,o&&(r=2&l[0]?o.return:l[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,l[1])).done)return r;switch(o=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,o=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){i.label=l[1];break}if(6===l[0]&&i.label<r[1]){i.label=r[1],r=l;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(l);break}r[2]&&i.ops.pop(),i.trys.pop();continue}l=n.call(e,i)}catch(e){l=[6,e],o=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};function X(){return R(this,void 0,void 0,(function(){return j(this,(function(e){return[2,{locations:[]}]}))}))}!function(e){R(this,void 0,void 0,(function(){var n,t,o,r,i,a,l;return j(this,(function(c){switch(c.label){case 0:return n=!1,[4,Promise.all([w.runAsync((function(){return e.NikePrivacy})),w.runAsync((function(){return e.analyticsClient})),w.runAsync((function(){return e.alloy}))])];case 1:return t=c.sent(),o=t[0],r=t[1],i=t[2],o||(n=!0,e.newrelic.addPageAction("EXP_OPTIMIZATION_CLIENT_WARN",{errorMessage:"Nike Privacy is not available."})),r||(n=!0,e.newrelic.addPageAction("EXP_OPTIMIZATION_CLIENT_WARN",{errorMessage:"Analytics Client is not available."})),i||(n=!0,console.error("Alloy not available.")),e.webShellClient&&(a=new M(i,[]).getLocations,l=e.webShellClient,e.newrelic.addPageAction("OPTIMIZATION_CLIENT_INITIALIZED",{}),n?(l.optimization.getLocations=X,l.optimization.__WS_UNSTABLE__.getLocations=X):(l.optimization.getLocations=a,l.optimization.__WS_UNSTABLE__.getLocations=a)),[2]}}))}))}(window)})();